% Technical review - kvm/arm
\section{KVM/ARM}

KVM for ARM - это виртуализационное решение для ARM, основанное на KVM, которое позволяет запускать гостевую ОС, практически не изменяя ее. Такой подход называется легковесной паравиртуализацией (Lightweight paravirtualization). 

Ядро модифицируется, используя специальный скрипт, который заменяет sensitive non-privileged инструкции на trap (исключения) и эмулирует такие инструкции программно. Интструкция SWI всегда вызывает исключение (trap) и обычно используется для системных вызовов (system calls). У SWI есть 24-битное поле, которое можно использовать для кодирования sesitive инструкций. Но, так как 24 бит недостаточно для кодирования всех sensitive инструкций и их операндов, KVM ARM дополнительно использует сопроцессоры. Монитор должен уметь различать системные вызовы и исключения (traps) для sensitive инструкций, поэтому в user режиме SWI инструкций распознается как syscall из гостевого пространства пользователя в гостевое ядро, а в supervisor как исключение sensitive инструкции.

 